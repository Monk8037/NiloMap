<!DOCTYPE html>
<html>
<head>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY"></script>
    <script>
        function initMap(events) {
            var map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 52.453802, lng: -2.010665 },
                zoom: 7
            });

            var eventData = JSON.parse(decodeURIComponent(events));

            eventData.forEach(function(event) {
                var marker = new google.maps.Marker({
                    position: { lat: parseFloat(event.Latitude), lng: parseFloat(event.Longitude) },
                    map: map,
                    title: event.Title,
                    label: event.Title.charAt(0)
                });

                var infoWindow = new google.maps.InfoWindow({
                    content: "<h3>" + event.Title + "</h3><p>" + event.Status + "</p>"
                });

                marker.addListener('click', function() {
                    infoWindow.open(map, marker);
                });
            });
        }

        window.addEventListener('message', function(e) {
            if (e.data) {
                initMap(e.data);
            }
        }, false);
    </script>
</head>
<body>
    <div id="map" style="width:100%;height:100%;"></div>
</body>
</html>
